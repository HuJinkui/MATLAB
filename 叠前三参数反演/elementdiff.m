function [dRdvp1,dRdvp2,dRdvs1,dRdvs2,dRdp1,dRdp2]=elementdiff(vp1,vp2,vs1,vs2,p1,p2,thet_)

dRdvp1=((tan(thet_)^2/2 + 1/2)*(vp1 - vp2))/(2*(vp1/2 + vp2/2)^2)... 
        - (tan(thet_)^2/2 + 1/2)/(vp1/2 + vp2/2) ...
        - (4*sin(thet_)^2*(vs1/2 + vs2/2)*(vs1 - vs2))/(vp1/2 + vp2/2)^3 ...
        - (2*sin(thet_)^2*(vs1/2 + vs2/2)^2*(p1 - p2))/((vp1/2 + vp2/2)^3*(p1/2 + p2/2));
dRdvp2=(tan(thet_)^2/2 + 1/2)/(vp1/2 + vp2/2)...
       + ((tan(thet_)^2/2 + 1/2)*(vp1 - vp2))/(2*(vp1/2 + vp2/2)^2) ...
       - (4*sin(thet_)^2*(vs1/2 + vs2/2)*(vs1 - vs2))/(vp1/2 + vp2/2)^3 ...
       - (2*sin(thet_)^2*(vs1/2 + vs2/2)^2*(p1 - p2))/((vp1/2 + vp2/2)^3*(p1/2 + p2/2));
dRdvs1=(4*sin(thet_)^2*(vs1/2 + vs2/2))/(vp1/2 + vp2/2)^2 ...
       + (2*sin(thet_)^2*(vs1 - vs2))/(vp1/2 + vp2/2)^2 ...
       + (2*sin(thet_)^2*(vs1/2 + vs2/2)*(p1 - p2))/((vp1/2 + vp2/2)^2*(p1/2 + p2/2)) ;
dRdvs2=(2*sin(thet_)^2*(vs1 - vs2))/(vp1/2 + vp2/2)^2 ...
       - (4*sin(thet_)^2*(vs1/2 + vs2/2))/(vp1/2 + vp2/2)^2 ...
       + (2*sin(thet_)^2*(vs1/2 + vs2/2)*(p1 - p2))/((vp1/2 + vp2/2)^2*(p1/2 + p2/2));
dRdp1=((2*sin(thet_)^2*(vs1/2 + vs2/2)^2)/(vp1/2 + vp2/2)^2 - 1/2)/(p1/2 + p2/2) ...
       - ((p1 - p2)*((2*sin(thet_)^2*(vs1/2 + vs2/2)^2)/(vp1/2 + vp2/2)^2 - 1/2))/(2*(p1/2 + p2/2)^2);
dRdp2=- ((2*sin(thet_)^2*(vs1/2 + vs2/2)^2)/(vp1/2 + vp2/2)^2 - 1/2)/(p1/2 + p2/2) ...
      - ((p1 - p2)*((2*sin(thet_)^2*(vs1/2 + vs2/2)^2)/(vp1/2 + vp2/2)^2 - 1/2))/(2*(p1/2 + p2/2)^2);

